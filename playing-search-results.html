<!--
`playing-search-results`
@group Playing UI
@element playing-search-results
-->
<dom-module id="playing-search-results">
  <template>

    <style>
      playing-saved-search-actions {
        @apply(--layout-end-justified);
      }

      ::content mostly-data-table, ::content mostly-data-grid {
        display: block;
        position: relative;
        min-height: calc(100vh - 130px);
      }

      ::content .ellipsis {
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        display: block;
      }

      ::content .capitalize {
        text-transform: capitalize;
      }
    </style>

    <mostly-page>
      <div class="header">
        <span class="flex">[[i18n('searchResults.results')]]</span>
        <playing-saved-search-actions id="actions" class="actions" search-form="[[searchForm]]"></playing-saved-search-actions>
      </div>
      <div class="content">
        <mostly-layout id="results" href="[[_resultsHref]]" model="[[_resultsModel]]" error="[[i18n('searchResults.layoutNotFound', searchName)]]"></mostly-layout>
      </div>
    </mostly-page>

  </template>

  <script>
    Polymer({
      is: 'playing-search-results',

      behaviors: [Nuxeo.I18nBehavior],

      properties: {
        searchForm: {
          type: Object,
          observer: '_searchFormChanged'
        }
      },

      listeners: {
        'results.navigate' : '_navigateFromSearch'
      },

      get element() {
        return this.$.results.element;
      },

      _searchFormChanged: function(searchForm) {
        this.nxProvider = searchForm.nxProvider;
        this.searchName = searchForm.searchName;

        var name = ['playing', this.searchName.toLowerCase(), 'search-results'].join('-');
        this._resultsHref = this.resolveUrl(['search', this.searchName.toLowerCase(), name + '.html'].join('/'));
        this._resultsModel = { nxProvider: this.nxProvider, name: this.searchName };
      },

      _navigateFromSearch: function(e) {
        if (this.searchForm) {
          this.searchForm.displayQueue(e.detail.doc);
        }
      }

    });
  </script>

</dom-module>
